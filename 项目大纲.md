# 工具项目大纲

# 一、项目基础信息

## 1.1 项目定位

- 面向 Windows 用户的轻量级、高性能、可定制化截图工具，主打“原生速度、功能精准、无广告、隐私友好”

- 弥补 Windows 自带截图工具功能单一、第三方工具臃肿/广告泛滥的痛点，同时作为 Rust 开发 Windows 图形应用的实践标杆

## 1.2 目标用户

- 核心用户：Windows 办公人群（程序员、设计师、运营、学生）、内容创作者（自媒体、教程博主）

- 次要用户：游戏玩家（截图分享）、运维/测试人员（故障截图记录）

## 1.3 核心价值

- 性能优势：Rust 原生编译，启动<100ms，内存占用<50MB，远超 Electron 架构工具

- 功能全面：覆盖截图捕获、编辑、存储、分享、自动化全流程，无付费/广告限制

- 隐私安全：纯本地处理，无数据上传，配置/截图文件加密存储

- 深度定制：支持快捷键、存储规则、编辑布局等多维度自定义

## 1.4 开源规划

- 开源协议：MIT 协议

- 代码规范：遵循 Rust 官方风格指南（rustfmt + clippy）

- 分支管理：main（稳定版）、develop（开发版）、feature/*（功能分支）

# 二、核心功能模块

## 2.1 截图捕获模块（Capture）

### 2.1.1 截图模式

- 全屏截图：支持单显示器/多显示器选择，自动识别当前激活显示器

- 区域截图：拖拽选区，支持 Shift 锁定比例、Alt 吸附窗口边缘，滚轮缩放预览

- 窗口截图：自动识别顶层窗口，鼠标悬浮预览，可选排除窗口阴影/边框

- 滚动截图：适配浏览器/Office/文件夹，自定义滚动步长，自动拼接消除重复像素

- 延时截图：1~10 秒自定义延时，显示倒计时提示

### 2.1.2 触发方式

- 全局快捷键：默认 Win+Alt+S 启动区域截图，支持全功能自定义

- 托盘图标：系统托盘菜单触发各截图模式

- 命令行调用：支持 CLI 模式（如 rustshot --region）

## 2.2 截图编辑模块（Edit）

### 2.2.1 标注工具

- 基础图形：矩形/圆形/箭头/直线，支持颜色、粗细、透明度、虚线样式

- 自由画笔：支持压感（适配数位板），自定义画笔大小

- 文字标注：字体/大小/颜色/背景色自定义，支持换行、旋转（0~360°）

### 2.2.2 像素级修改

- 马赛克：自定义模糊半径，支持矩形/自由选区模糊

- 橡皮擦：自定义大小，擦除标注或截图内容

- 颜色拾取：提取像素 RGB/十六进制值，一键复制

### 2.2.3 画布操作

- 裁剪：精准输入宽高像素，支持自由裁剪

- 旋转/翻转：90° 步进或自由角度旋转，水平/垂直翻转

- 缩放：按比例/自定义尺寸，优化缩放算法避免模糊

- 撤销/重做：支持最多 20 步操作回退

## 2.3 存储与分享模块（Storage & Share）

### 2.3.1 本地存储

- 路径自定义：支持按日期创建文件夹（如 Screenshots/2025-12-05）

- 命名规则：自定义模板（如 {type}_{yyyyMMdd}_{HHmmss}.{format}）

- 格式选择：PNG/JPG/WebP，WebP 支持自定义压缩质量

### 2.3.2 剪贴板同步

- 自动复制：截图后默认复制到剪贴板，支持“仅复制”“保存+复制”模式切换

- 格式兼容：支持粘贴到 Word/微信等应用，处理 CF_DIB 等系统格式

### 2.3.3 分享功能

- 局域网分享：生成临时 HTTP 服务与二维码，手机扫码/访问链接获取截图

- 云存储上传（可选）：适配阿里云 OSS/腾讯云 COS，上传后复制链接

## 2.4 自动化与配置模块（Automation & Config）

### 2.4.1 自动化功能

- 定时截图：按时间间隔（1分钟~1小时）或固定时间点截图，指定窗口/全屏，自动保存

- 窗口监控截图：监控指定窗口，内容变化时自动截图，可设置忽略间隔

- 批量处理：历史截图批量格式转换、重命名、压缩

### 2.4.2 配置管理

- 可视化设置面板：快捷键、存储路径、主题、编辑默认参数等

- 配置导出/导入：支持备份个性化配置，跨设备迁移

- 主题定制：浅色/深色模式，适配系统主题，高对比度模式（无障碍）

# 三、技术架构设计

## 3.1 分层架构

1. UI 层：egui + winit，负责交互组件与事件处理

2. 核心服务层：封装截图、编辑、存储、配置等核心逻辑，提供统一接口

3. 平台适配层：Windows API 封装（显示器、窗口、剪贴板等），处理 DPI 缩放等系统特性

4. 基础工具层：日志、错误处理、数据转换、加密等通用功能

## 3.2 核心技术栈

|类别|依赖库|用途|
|---|---|---|
|Windows API|windows = "0.56"|调用用户32/内核32 API，处理显示器、窗口、剪贴板等|
|GUI|egui = "0.22"、eframe = "0.22"|纯 Rust 原生 GUI，实现编辑画布与设置界面|
|图形处理|image = "0.24"、resvg = "0.36"|位图编解码、裁剪拼接、矢量图形渲染|
|异步/并发|tokio = "1.0"|异步文件操作、定时器、网络请求|
|快捷键|hotkey-rs|注册与监听全局快捷键|
|配置管理|serde = "1.0"、toml = "0.8"|配置文件序列化/反序列化|
|打包工具|cargo-wix = "0.40"|生成 Windows .msi 安装包|
## 3.3 关键技术解决方案

- DPI 适配：封装 DpiManager，统一处理逻辑/物理坐标转换，缓存显示器 DPI 值

- 滚动截图拼接：分块捕获时记录重叠区域，使用 image::imageops::overlay 合并

- 编辑性能优化：实现“脏矩形”渲染，仅重绘修改区域

- 快捷键冲突：注册前检测，冲突时提供备选快捷键列表

- 大文件保存：异步写入文件（tokio::fs），避免阻塞 UI 线程

# 四、开发与发布规划

## 4.1 开发阶段划分

|阶段|周期|核心目标|关键交付物|
|---|---|---|---|
|阶段1：MVP|1个月|基础截图+简单编辑+本地保存|区域/窗口/全屏截图、基础标注、本地保存/剪贴板同步|
|阶段2：功能完善|1个月|完善编辑+滚动截图|文字标注/马赛克/颜色拾取、滚动截图、自定义快捷键|
|阶段3：进阶功能|1个月|自动化+分享功能|定时截图/窗口监控、局域网分享、配置管理面板|
|阶段4：优化发布|1个月|性能优化+打包发布|渲染优化/Bug修复、便携版/安装版、文档+开源发布|
## 4.2 发布与分发

- 发布渠道：GitHub Releases（主渠道）、Gitee（国内镜像）

- 包类型：便携版（单 exe 免安装）、安装版（.msi 带快捷方式/右键菜单）

- 版本命名：遵循 SemVer 规范（v0.1.0、v0.5.0、v1.0.0）

- 更新机制：v1.0 后集成自动更新，通过 GitHub Releases 检查新版本

# 五、风险与应对

- Windows 版本兼容性：测试覆盖 Win10 1709+、Win11 21H2+，低版本系统功能降级

- 窗口截图失败：提供“兼容模式”（GDI 捕获），提示用户切换

- 杀毒软件误报：提交白名单，后期添加数字签名，README 说明误报处理

- 低配电脑性能：实现“性能模式”，降低渲染分辨率、关闭部分特效

# 六、社区与文档

## 6.1 文档体系

- README.md：项目介绍、功能列表、快速开始、下载链接、贡献指南

- USER_GUIDE.md：详细使用教程（快捷键、操作步骤、配置说明）

- DEV_GUIDE.md：开发环境搭建、架构说明、调试技巧、贡献流程

- CHANGELOG.md：版本更新日志（功能新增、Bug 修复、优化）

## 6.2 社区运营

- 反馈渠道：GitHub Issues 分类（Bug 报告、功能请求、疑问）

- 贡献激励：列出贡献者名单，核心贡献者授予维护者权限

- 技术交流：Discussions 板块解答问题，分享开发经验
> （注：文档部分内容可能由 AI 生成）